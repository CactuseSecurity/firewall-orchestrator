query show_manufacturers {
  stm_dev_typ {
    dev_typ_manufacturer
    dev_typ_version
  }
}

query show_managements {
	management {
    mgm_id
    mgm_name
  }
}

query show_devices {
  device {
    dev_id
    dev_name
    stm_dev_typ {
      dev_typ_name
      dev_typ_version
    }
  }
}

query show_devices_by_mgmt {
  management {
    mgm_name
    devices {
      dev_name
    }
  }
}

query show_devices_by_mgmt {
  management {
    mgm_name
    devices {
      dev_name
      stm_dev_typ {
        dev_typ_name
        dev_typ_version
      }
    }
  }
}

#Query variables:
#{
#  "rule_id":156
#}
query getSpecificRuleById($rule_id: Int!) {
  __typename
  rule(where: {rule_id: {_eq: $rule_id}}) {
    rule_id
    rule_src
    rule_dst
  }
}

query filter_dyn($manufacturer_id: [Int!]) {
  __typename
  stm_dev_typ(where: {dev_typ_id: {_in: $manufacturer_id}}) {
    dev_typ_name
    dev_typ_version
    dev_typ_id
  }
}

query filter_dyn($management_id: [Int!], $device_id: [Int!]) {
  __typename
    management(where: {mgm_id: {_in: $management_id}}) {
      mgm_id
      mgm_name
      devices(where: {dev_id: {_in: $device_id}}) {
        dev_id
        dev_name
      }
    }
  }

query filter_dyn($manufacturer_id: [Int!]!, $management_id: [Int!]!) {
  __typename
  stm_dev_typ(where: {dev_typ_id: {_in: $manufacturer_id}}) {
    dev_typ_name
    dev_typ_version
    dev_typ_id
    management(where: {mgm_id: {_in: $management_id}}) {
      mgm_id
      mgm_name
    }
  }
}

query filter_dyn($manufacturer_id: [Int!]!, $management_id: [Int!], $device_id: [Int!]) {
  __typename
  stm_dev_typ(where: {dev_typ_id: {_in: $manufacturer_id}}) {
    dev_typ_name
    dev_typ_version
    dev_typ_id
    management(where: {mgm_id: {_in: $management_id}}) {
      mgm_id
      mgm_name
      devices(where: {dev_id: {_in: $device_id}}) {
        dev_id
        dev_name
      }
    }
  }
}

query listRules($management_id: [Int!], $device_id: [Int!]) {
  __typename
  management(where: {mgm_id: {_in: $management_id}}) {
    mgm_id
    mgm_name
    devices(where: {dev_id: {_in: $device_id}}) {
      dev_id
      dev_name
      rules(where: {active: {_eq: true}, rule_disabled: {_eq: false}}, order_by: {rule_num: asc}) {
        rule_num
        rule_src
        rule_dst
        rule_svc
        rule_action
        rule_track
      }
    }
  }
}

query listRules($management_id: [Int!], $device_id: [Int!], $rule_src_name: [String!], $rule_src_ip: [String!]) {
  management(where: {mgm_id: {_in: $management_id}}) {
    mgm_id
    mgm_name
    devices(where: {dev_id: {_in: $device_id}}) {
      dev_id
      dev_name
      rules(where: {active: {_eq: true}, rule_src: {_in: $rule_src_name}, rule_disabled: {_eq: false}}, order_by: {rule_num: asc, rule_froms_aggregate: {}}) {
        rule_num
        rule_src
        rule_froms {
          object {
            ...objectFragment
          }
        }
        rule_dst
        rule_svc
        rule_action
        rule_track
      }
    }
  }
}

fragment objectFragment on object {
  obj_ip
}

query listRules($management_id: [Int!], $device_id: [Int!], $rule_src_name: [String!], $rule_src_ip: [cidr!]) {
  management(where: {mgm_id: {_in: $management_id}}) {
    mgm_id
    mgm_name
    devices(where: {dev_id: {_in: $device_id}}) {
      dev_id
      dev_name
      rules(where: {active: {_eq: true}, rule_src: {_in: $rule_src_name}, rule_disabled: {_eq: false}, rule_froms: {object: {obj_ip: {_in: $rule_src_ip}}}}, order_by: {rule_num: asc}) {
        rule_num
        rule_src
        rule_froms {
          object {
            obj_ip
          }
        }
        rule_dst
        rule_svc
        rule_action
        rule_track
      }
    }
  }
}
