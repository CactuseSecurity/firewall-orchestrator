query getRulesWithViolationsInTimespanByChunk(
  $limit: Int
  $offset: Int
  $active: Boolean
  $import_id_start: bigint
  $import_id_end: bigint
  $from_date: timestamptz
  $to_date: timestamptz
) {
  rule(
    limit: $limit
    offset: $offset
    order_by: { rule_id: asc }
  ) {
    ...ruleDetails

    violations: compliance_violations(
      where: {
        _or: [
          { removed_date: { _gte: $from_date, _lt: $to_date } }
          { found_date:   { _gte: $from_date, _lt: $to_date } }
        ]
      }
    ) {
      id
      rule_id
      found_date
      removed_date
      details
      risk_score
      policy_id
      criterion_id
    }

    rulebase: rulebase {
      id
      name
    }
  }
}