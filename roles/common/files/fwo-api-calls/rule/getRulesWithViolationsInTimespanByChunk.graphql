query getRulesWithViolationsInTimespanByChunk(
  $limit: Int
  $offset: Int
  $active: Boolean
  $import_id_start: bigint
  $import_id_end: bigint
  $mgm_ids: [Int!]
  $violations_where: compliance_violation_bool_exp!
) {
  rule(
    limit: $limit
    offset: $offset
    order_by: { rule_uid: asc }
    where: { removed: { _is_null: true } mgm_id: { _in: $mgm_ids }}
  ) {
    rule_src
    rule_dst
    ...ruleDetails

    violations: compliance_violations_version_agnostic(
      where: $violations_where
    ) {
      id
      rule_id
      rule_uid
      mgmt_uid
      found_date
      removed_date
      details
      risk_score
      policy_id
      criterion_id
      criterion: criterion{
        id
        name
        criterion_type
      }
    }

    rulebase: rulebase {
      id
      name
    }
  }
}