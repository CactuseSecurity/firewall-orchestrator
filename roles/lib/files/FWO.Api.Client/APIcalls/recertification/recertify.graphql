mutation recertify(
  $ruleMetadataId: bigint!
  $ruleId: bigint!
  $ownerId: Int!
  $userDn: String
  $recertified: Boolean
  $recertDate: timestamp
  $comment: String
  ) {
  update_recertification(
    where: {_and: [{rule_metadata_id: {_eq: $ruleMetadataId}}, {owner_id: {_eq: $ownerId}}, {recert_date: {_is_null: true}}]},
    _set: {
      rule_id: $ruleId
      user_dn: $userDn
      recertified: $recertified
      recert_date: $recertDate
      comment: $comment
      }
    ) {
      affected_rows
    }
  }
