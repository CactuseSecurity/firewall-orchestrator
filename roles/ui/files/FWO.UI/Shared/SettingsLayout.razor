@using FWO.Config.Api
@using FWO.Config.Api.Data
@using FWO.Basics
@using FWO.Api.Data

@inherits LayoutComponentBase
@layout MainLayout

@inject UserConfig userConfig

<Sidebar PositionLeft="true" Collapsible="true" Resizeable="true" @bind-Width="sidebarWidth">
    <div class="me-2 ms-2 mt-4 mb-4">
        <ul class="navbar-nav navbar-dark flex-column">
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Importer}, {Roles.Auditor}, {Roles.FwAdmin}")">
                <li class="nav-item px-2" data-toggle="tooltip" title="@(userConfig.GetText("U5011"))">
                    <h5>@(userConfig.GetText("devices"))</h5>
                </li>
            </AuthorizeView>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Auditor}, {Roles.FwAdmin}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/credentials">
                        <span class="@Icons.Credential"></span> @(userConfig.GetText("import_credential"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/managements">
                        <span class="@Icons.Management"></span> @(userConfig.GetText("managements"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/gateways">
                        <span class="@Icons.Gateway"></span> @(userConfig.GetText("gateways"))
                    </NavLink>
                </li>
            </AuthorizeView>
            <hr />
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Auditor}, {Roles.FwAdmin}")">
                <li class="nav-item px-2" data-toggle="tooltip" title="@(userConfig.GetText("U5012"))">
                    <h5>@(userConfig.GetText("authorization"))</h5>
                </li>
            </AuthorizeView>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Auditor}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/ldap">
                        <span class="@Icons.Ldap"></span> @(userConfig.GetText("ldap_conns"))
                    </NavLink>
                </li>
            </AuthorizeView>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Auditor}, {Roles.FwAdmin}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/tenants">
                        <span class="@Icons.Tenant"></span> @(userConfig.GetText("tenants"))
                    </NavLink>
                </li>
            </AuthorizeView>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Auditor}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/users">
                        <span class="@Icons.User"></span> @(userConfig.GetText("users"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/groups">
                        <span class="@Icons.UserGroup"></span> @(userConfig.GetText("groups"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/roles">
                        <span class="@Icons.Role"></span> @(userConfig.GetText("roles"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/owners">
                        <span class="@Icons.Owner"></span> @(userConfig.GetText("owners"))
                    </NavLink>
                </li>
                <hr />
                <li class="nav-item px-2" data-toggle="tooltip" title="@(userConfig.GetText("U5013"))">
                    <h5>@(userConfig.GetText("defaults"))</h5>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/email">
                        <span class="@Icons.Email"></span> @(userConfig.GetText("email_settings"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/importer">
                        <span class="@Icons.Import"></span> @(userConfig.GetText("importer_settings"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/defaults">
                        <span class="@Icons.Settings"></span> @(userConfig.GetText("standards"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/recertificationgeneral">
                        <span class="@Icons.Recertification"></span> @(userConfig.GetText("recertification"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/modelling">
                        <span class="@Icons.Modelling"></span> @(userConfig.GetText("modelling"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/extticketing">
                        <span class="@Icons.Tickets"></span> @(userConfig.GetText("ext_ticketing"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/passwordpolicy">
                        <span class="@Icons.Policy"></span> @(userConfig.GetText("password_policy"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/customtexts">
                        <span class="@Icons.Text"></span> @(userConfig.GetText("customize_texts"))
                    </NavLink>
                </li>
                <hr />
                <li class="nav-item px-2" data-toggle="tooltip" title="@(userConfig.GetText("U5015"))">
                    <h5>@(userConfig.GetText("workflow"))</h5>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/stateactions">
                        <span class="@Icons.Action"></span> @(userConfig.GetText("state_actions"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/statedefinitions">
                        <span class="@Icons.State"></span> @(userConfig.GetText("state_definitions"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/statematrix">
                        <span class="@Icons.Matrix"></span> @(userConfig.GetText("state_matrix"))
                    </NavLink>
                </li>
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/workflowcustomizing">
                        <span class="@Icons.Settings"></span> @(userConfig.GetText("customizing"))
                    </NavLink>
                </li>
            </AuthorizeView>
                <hr />
            <li class="nav-item px-2" data-toggle="tooltip" title="@(userConfig.GetText("U5014"))">
                <h5>@(userConfig.GetText("personal"))</h5>
            </li>
            <li class="nav-item px-2">
                @if (userConfig.User.Dn.EndsWith(GlobalConst.kLdapInternalPostfix))
                {
                    <NavLink class="nav-link" href="settings/password">
                        <span class="@Icons.Login"></span> @(userConfig.GetText("password"))
                    </NavLink>
                }
                <NavLink class="nav-link" href="settings/language">
                    <span class="@Icons.Language"></span> @(userConfig.GetText("language"))
                </NavLink>
                <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Reporter}, {Roles.ReporterViewAll}, {Roles.Recertifier}, {Roles.Auditor}, {Roles.FwAdmin}")">
                    <NavLink class="nav-link" href="settings/report">
                        <span class="@Icons.Reporting"></span> @(userConfig.GetText("reporting"))
                    </NavLink>
                </AuthorizeView>
            </li>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Recertifier}, {Roles.Auditor}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/recertificationpersonal">
                        <span class="@Icons.Recertification"></span> @(userConfig.GetText("recertification"))
                    </NavLink>
                </li>
            </AuthorizeView>
            <AuthorizeView Roles="@($"{Roles.Admin}, {Roles.Modeller}, {Roles.Auditor}")">
                <li class="nav-item px-2">
                    <NavLink class="nav-link" href="settings/modellingpersonal">
                        <span class="@Icons.Modelling"></span> @(userConfig.GetText("modelling"))
                    </NavLink>
                </li>
            </AuthorizeView>
        </ul>
    </div>
</Sidebar>

    
<div style="margin-left: @($"{sidebarWidth + 20}px");">
    @Body
</div>

@code
{
    private int sidebarWidth = 250;
    
    protected override void OnInitialized()
    {
        userConfig.OnChange += OnChange;
    }

    private void OnChange(Config _, ConfigItem[] __)
    {
        Task.Run(async() => await InvokeAsync(StateHasChanged));
    }
}

